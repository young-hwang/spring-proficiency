<!DOCTYPE html>
<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Spring AI</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.bundle.min.js"></script>
  <link href="/css/springai.css" rel="stylesheet" />
  <script src="/js/springai.js"></script>
  <script>
    // ##### 제출 버튼을 클릭했을 때 실행하는 함수 #####
    async function handleSubmit() {
      try {
        // 텍스트 질문을 얻고 대화 패널에 추가하기
        const question = document.getElementById("question").value;
        if (question === "") return;
        springai.addUserQuestion(question, "chatPanel");

        // 응답이 오기까지 스피너 보여주기
        springai.setSpinner("spinner", true);

        // AJAX 요청하고 응답받기
        const response = await fetch('/ai/self-consistency', {
          method: "post",
					headers: {
						'Content-Type': 'application/x-www-form-urlencoded',
						'Accept': 'text/plain'
					},
          body: new URLSearchParams({ content: question })
        });

        // AI 모델 답변이 들어갈 위치를 대화 패널에 추가
        const uuid = springai.addAnswerPlaceHolder("chatPanel");
        
        // 텍스트 답변 출력하기
        springai.printAnswerText(response.body, uuid, "chatPanel");
      } catch (error) {
        console.log(error)
      } finally {
        //스피너 숨기기
        springai.setSpinner("spinner", false);
      }
    } 
  </script>
</head>

<body>
  <div class="d-flex flex-column vh-100">
    <div id="headPanel" class="navbar justify-content-between">
      <a href="/" class="navbar-brand ps-2">
        <img src="/image/spring_ai_logo_with_text.svg" width="200" />
      </a>
      <div id="spinner" class="spinner-border text-success d-none me-3" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
    </div>

    <div id="chatPanel" class="flex-grow-1 container-fluid h-100 my-2" style="overflow-y:auto; overflow-x:hidden;">
      <div class="d-flex justify-content-start border-bottom m-2">
        <table>
          <tr>
            <td><img src="/image/assistant.png" width="50" /></td>
            <td><span>자기 일관성을 이용해서 중요함, 중요하지 않음으로 분류합니다.</span></td>
          </tr>
        </table>
      </div>
    </div>

    <div id="inputPanel" class="bg-secondary-subtle">
      <div class="input-group p-2">
        <span class="input-group-text">메일 내용</span>
        <!--안녕하세요, 저는 당신이  개발한 웹 관리 시스템을 사용해보았습니다. 정말 훌륭한 오픈 소스 콘텐츠 관리 시스템이죠. 많은 멋진 사용자 플러그인들이 제공되고, 설정하기도 꽤 쉽습니다. 하지만 연락처 양식에서 버그를 발견했어요. 이름 필드를 선택할 때 발생하는 문제입니다. 제가 이름 필드에 텍스트를 입력하는 화면을 첨부한 스크린샷을 참고해주세요. 제가 호출한 JavaScript 알림 상자를 확인할 수 있습니다. 그렇지만 나머지는 정말 좋은 웹사이트입니다. 저는 그것을 사용하는 것을 즐깁니다그 버그는 웹사이트에 남겨두셔도 괜찮아요, 그게 저에게 더 재미있는 읽을 거리를 제공하니까요. 감사합니다.-->
        <!--안녕하세요, 저는 당신이  개발한 웹 관리 시스템을 사용해보았습니다. 정말 훌륭한 오픈 소스 콘텐츠 관리 시스템입니다.-->
        <textarea id="question" class="form-control">안녕하세요, 저는 당신이  개발한 웹 관리 시스템을 사용해보았습니다. 정말 훌륭한 오픈 소스 콘텐츠 관리 시스템이죠. 많은 멋진 사용자 플러그인들이 제공되고, 설정하기도 꽤 쉽습니다. 하지만 연락처 양식에서 버그를 발견했어요. 이름 필드를 선택할 때 발생하는 문제입니다. 제가 이름 필드에 텍스트를 입력하는 화면을 첨부한 스크린샷을 참고해주세요. 제가 호출한 JavaScript 알림 상자를 확인할 수 있습니다. 그렇지만 나머지는 정말 좋은 웹사이트입니다. 저는 그것을 사용하는 것을 즐깁니다그 버그는 웹사이트에 남겨두셔도 괜찮아요, 그게 저에게 더 재미있는 읽을 거리를 제공하니까요. 감사합니다.</textarea>
        <span class="input-group-text">
          <button type="button" class="btn btn-primary" onclick="handleSubmit()">제출</button>
        </span>
      </div>
    </div>
  </div>
</body>

</html>